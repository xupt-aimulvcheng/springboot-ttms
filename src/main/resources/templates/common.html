<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script th:src="@{/main/layui/layui.js}"></script>
    <link rel="stylesheet" th:href="@{/main/layui/css/layui.css}">
    <script th:src="@{/main/js/jquery-2.1.3.min.js}"></script>
    <script th:src="@{/main/js/day.js}" charset="utf-8"></script>
    <link rel="stylesheet" th:href="@{/main/css/movie_detail.css}">
    <script th:src="@{/main/js/vue.js}" charset="utf-8"></script>
</head>
<body>
<div id="selected">
    <table style="text-align: center;" id="demo"  lay-filter="test"></table>
</div>
</body>
</html>
<script th:inline="none">
    $(function () {
        function getWeekDate(date) {
            var now = new Date(date);
            var day = now.getDay();
            var weeks = new Array(
                "周日",
                "周一",
                "周二",
                "周三",
                "周四",
                "周五",
                "周六"
            );
            var week = weeks[day];
            return week;
        };
        let today = dayjs(getDate(0)).format('MM月DD日');
        console.log(today)
        let tomorrow = dayjs(getDate(1)).format('MM月DD日')
        let next = dayjs(getDate(2)).format('MM月DD日');
        let nextday = dayjs(getDate(3)).format('MM月DD日');
        $("#today").next(".layui-form-radio").find("div").text("今天 " + today);
        $("#tomorrow").next(".layui-form-radio").find("div").text("明天 " + tomorrow);
        $("#next").next(".layui-form-radio").find("div").text("后天 " + next);
        $("#nextday").next(".layui-form-radio").find("div").text(getWeekDate(getDate(3)) +" "+ nextday);
        layui.use(['table', 'form'], function () {
            var table = layui.table;
            var form = layui.form;
            //第一个实例
            table.render({
                elem: '#demo'
                ,height: 312
                ,id:'idTest'
                , url: '/plan/getPlanByMIdAndTime/' + $("#movie-id").val() //数据接口
                , where: {
                    Time: 0
                }
                ,css:'.layui-table-view {margin-left: 110px;}'
                , cols: [[ //表头
                    , {
                        field: 'startDate',
                        align: 'center',
                        title: '放映时间',
                        width: 320,
                        style: 'width: 320px;text-align: center;margin-top: 20px;height: 70px;font-weight: 700;',
                        templet: function (d) {
                            return dayjs(d.startDate).format('HH时MM分')
                        }
                    },
                    , {
                        field: 'hName',
                        align: 'center',
                        style: 'width:300px;text-align:center;font-size:16px',
                        title: '放映位置',
                        width: 300
                    }
                    , {
                        field: 'price', align: 'center', title: '售价', width: 329, templet: function (d) {
                            let price = d.price;
                            return '<span class="layui-icon layui-icon-rmb"></span>' + '<span style="margin-left:3px;font-size: 18px">' + price + '</span>';
                        }, style: 'color:red;width:329px;text-align:center;'
                    }
                    , {
                        title: '购票',
                        align: 'center',
                        width: 250,
                        fixed: 'right',
                        style: 'width:250px;height: 46px;',
                        toolbar: '#currentTableBar',
                        align: "center"
                    }
                ]]
                , width: 1200
                , skin: 'line'
            });
            form.on('radio(date)', function (data) {
                table.reloadData('idTest', {
                    where: {
                        Time: data.value
                    }
                })
            });
            table.on('tool(test)', function (obj) {
                var data = obj.data;
                console.log(data)
                if (obj.event === 'buyTicket') {
                    window.location = '/butTicket/'+data.id
                }
            });
        });
    })
</script>